<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ²–ãƒ‰ã‚­!DUO å®Ÿæˆ¦ç®¡ç†ãƒ„ãƒ¼ãƒ«</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #fff; padding: 10px; padding-bottom: 50px; }
        .card { background: #333; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #444; }
        h1 { font-size: 1.2rem; color: #ffcc00; text-align: center; margin-bottom: 20px; }
        h3 { margin-top: 0; color: #ffcc00; font-size: 1rem; border-bottom: 1px solid #555; padding-bottom: 5px; }
        label { display: block; margin-top: 10px; font-size: 0.85rem; color: #ccc; }
        select, input { width: 100%; padding: 12px; margin-top: 5px; border-radius: 5px; border: none; font-size: 1rem; box-sizing: border-box; }
        input[type="number"], input[type="text"] { background: #eee; color: #000; }
        .btn { background: #ff4444; color: white; padding: 12px; border: none; border-radius: 5px; width: 100%; font-weight: bold; margin-top: 15px; cursor: pointer; }
        .btn-save { background: #2196f3; margin-top: 15px; border: 1px solid #fff; }
        #result { margin-top: 15px; padding: 15px; border-radius: 5px; text-align: center; font-weight: bold; font-size: 1.1rem; }
        .safe { background: #2e7d32; color: white; }
        .danger { background: #c62828; color: white; }
        .sss { background: #fbc02d; color: #000; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        .table-container { overflow-x: auto; }
        table { width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 0.75rem; min-width: 400px; }
        th, td { border: 1px solid #555; padding: 8px; text-align: center; }
        th { background: #444; color: #ffcc00; }
        tr:nth-child(even) { background: #3a3a3a; }
    </style>
</head>
<body>

    <h1>ğŸŒº æ²–ãƒ‰ã‚­!DUO å®Ÿæˆ¦ç®¡ç†ãƒ„ãƒ¼ãƒ«</h1>

    <div class="card">
        <h3>1. ç‹™ã„ç›®åˆ¤å®š</h3>
        <label>çŠ¶æ³</label>
        <select id="state">
            <option value="heaven">å¤©å›½æŠœã‘å¾Œ</option>
            <option value="reset">ãƒªã‚»ãƒƒãƒˆå¾Œ</option>
        </select>
        <label>ã‚¹ãƒ«ãƒ¼å›æ•°</label>
        <select id="thru">
            <option value="0">0ã‚¹ãƒ«ãƒ¼</option>
            <option value="1">1ã‚¹ãƒ«ãƒ¼</option>
            <option value="2">2ã‚¹ãƒ«ãƒ¼</option>
            <option value="3">3ã‚¹ãƒ«ãƒ¼</option>
            <option value="4">4ã‚¹ãƒ«ãƒ¼ä»¥ä¸Š</option>
        </select>
        <label>æ‰“ã¡å§‹ã‚ (G)</label>
        <input type="number" id="games" placeholder="ä¾‹: 150">
        <label>ç‰¹æ®Šæ¡ä»¶</label>
        <div style="margin-top:10px; line-height: 2.2; font-size: 0.9rem;">
            <input type="checkbox" id="kari_loop" style="width:auto;"> <span style="color:#00ffff;">ä»®å¤©ãƒ«ãƒ¼ãƒ—ä¸­</span> / 
            <input type="checkbox" id="dhc_fail" style="width:auto;"> <span style="color:#ffcc00;">DHCå¤±æ•—å¾Œ</span><br>
            <input type="checkbox" id="over2500" style="width:auto;"> 2500æšoræœ‰åˆ©åˆ‡æ–­ / 
            <input type="checkbox" id="flash2" style="width:auto;"> ãƒ™ãƒ«ãƒ•ãƒ©â‘¡
        </div>
        <button class="btn" onclick="checkExpectation()">æœŸå¾…å€¤ã‚’åˆ¤å®š</button>
        <div id="result" style="display:none;"></div>
    </div>

    <div class="card">
        <h3>2. å½“é¸ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h3>
        <label>å½“é¸ã‚²ãƒ¼ãƒ æ•° (G)</label>
        <input type="number" id="win_games" placeholder="å®Ÿéš›ã«å½“ãŸã£ãŸGæ•°">
        <label>å®Ÿæˆ¦ãƒ¡ãƒ¢</label>
        <input type="text" id="memo" placeholder="ä¾‹: å¤•æ–¹ã€ãƒ‰ã‚­ãƒãƒŠå¤±æ•—ç­‰">
        <button class="btn btn-save" onclick="saveRecord()">å®Ÿæˆ¦ãƒ‡ãƒ¼ã‚¿ã‚’å±¥æ­´ã«ä¿å­˜</button>
    </div>

    <div class="card">
        <h3>ğŸ“Š ç¨¼åƒå±¥æ­´é›†è¨ˆ</h3>
        <div class="table-container">
            <table id="historyTable">
                <thead>
                    <tr>
                        <th>çŠ¶æ³</th>
                        <th>ã‚¹ãƒ«ãƒ¼</th>
                        <th>é–‹å§‹G</th>
                        <th>å½“é¸G</th>
                        <th>ãƒ¡ãƒ¢</th>
                    </tr>
                </thead>
                <tbody id="historyBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        function checkExpectation() {
            const state = document.getElementById('state').value;
            const thru = parseInt(document.getElementById('thru').value);
            const games = parseInt(document.getElementById('games').value) || 0;
            const kariLoop = document.getElementById('kari_loop').checked;
            const dhcFail = document.getElementById('dhc_fail').checked;
            const over2500 = document.getElementById('over2500').checked;
            const flash2 = document.getElementById('flash2').checked;
            
            const resDiv = document.getElementById('result');
            resDiv.style.display = "block";
            
            if (thru <= 3 && games > 400) {
                resDiv.className = "danger";
                resDiv.innerHTML = "ã€NGã€‘400Gè¶…ãˆã¯æ·±è¿½ã„å³ç¦ï¼";
                return;
            }
            if (dhcFail || over2500) {
                resDiv.className = "sss";
                resDiv.innerHTML = "ã€SSSç´šã€‘æœŸå¾…å€¤æœ€é«˜ï¼<br>æ‰“ã£ã¡ã‚ƒãˆãƒ‹ãƒƒã‚µãƒ³â€¼ï¸";
                return;
            }
            if (flash2) {
                resDiv.className = "safe";
                resDiv.innerHTML = "ã€ãƒ¢ãƒ¼ãƒ‰Bæ¿ƒåšã€‘<br>æ‰“ã£ã¡ã‚ƒãˆãƒ‹ãƒƒã‚µãƒ³â€¼ï¸";
                return;
            }

            let border = 999;
            if (state === "reset") {
                if (thru === 0) border = 230;
                else if (thru === 1) border = kariLoop ? 150 : 220;
                else border = 150; 
            } else {
                if (thru === 0) border = kariLoop ? 150 : 280;
                else if (thru === 1) border = kariLoop ? 150 : 200;
                else if (thru === 2) border = kariLoop ? 120 : 150;
                else if (thru === 3) border = kariLoop ? 150 : 200;
                else if (thru === 4) border = 0;
            }

            if (games >= border) {
                resDiv.className = "safe";
                resDiv.innerHTML = `ã€ç‹™ã„ç›®ã€‘${border}Gã‚¯ãƒªã‚¢ï¼<br>æ‰“ã£ã¡ã‚ƒãˆãƒ‹ãƒƒã‚µãƒ³â€¼ï¸`;
            } else {
                resDiv.className = "danger";
                resDiv.innerHTML = `ã€å¾…æ©Ÿã€‘ã‚ã¨ ${border - games}G å¿…è¦`;
            }
        }

        function saveRecord() {
            const state = document.getElementById('state').selectedOptions[0].text;
            const thru = document.getElementById('thru').value;
            const startG = document.getElementById('games').value || "-";
            const winG = document.getElementById('win_games').value || "-";
            const memoText = document.getElementById('memo').value || "-";
            
            const tbody = document.getElementById('historyBody');
            const row = tbody.insertRow(0);
            row.innerHTML = `<td>${state}</td><td>${thru}</td><td>${startG}</td><td>${winG}</td><td>${memoText}</td>`;
            
            document.getElementById('win_games').value = "";
            document.getElementById('memo').value = "";
            alert("ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼");
        }
    </script>
</body>
</html>
