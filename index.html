<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ²–ãƒ‰ã‚­!DUO å®Œå…¨æ”»ç•¥ãƒ„ãƒ¼ãƒ« V2</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #fff; padding: 10px; padding-bottom: 50px; }
        .tabs { display: flex; margin-bottom: 15px; border-bottom: 2px solid #555; }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; background: #333; color: #aaa; font-weight: bold; transition: 0.3s; }
        .tab.active { background: #ff4444; color: #fff; border-radius: 5px 5px 0 0; }
        .content { display: none; }
        .content.active { display: block; }
        
        .card { background: #333; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #444; }
        h1 { font-size: 1.2rem; color: #ffcc00; text-align: center; margin-bottom: 20px; text-shadow: 1px 1px 2px #000; }
        h3 { margin-top: 0; color: #ffcc00; font-size: 1rem; border-bottom: 1px solid #555; padding-bottom: 5px; margin-bottom: 10px; }
        
        /* ãƒ„ãƒ¼ãƒ«ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        label { display: block; margin-top: 10px; font-size: 0.85rem; color: #ccc; }
        select, input { width: 100%; padding: 12px; margin-top: 5px; border-radius: 5px; border: none; font-size: 1rem; box-sizing: border-box; }
        input[type="number"], input[type="text"] { background: #eee; color: #000; }
        .btn { background: #ff4444; color: white; padding: 12px; border: none; border-radius: 5px; width: 100%; font-weight: bold; margin-top: 15px; cursor: pointer; }
        .btn-save { background: #2196f3; margin-top: 15px; border: 1px solid #fff; }
        #result { margin-top: 15px; padding: 15px; border-radius: 5px; text-align: center; font-weight: bold; font-size: 1.1rem; }
        .safe { background: #2e7d32; color: white; }
        .danger { background: #c62828; color: white; }
        .sss { background: #fbc02d; color: #000; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }

        /* è§£æç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .info-table { width: 100%; font-size: 0.8rem; border-collapse: collapse; margin-top: 5px; }
        .info-table th, .info-table td { border: 1px solid #555; padding: 8px; text-align: left; vertical-align: middle; }
        .info-table th { background: #444; color: #ffcc00; width: 35%; }
        .highlight { color: #ff4444; font-weight: bold; }
        .blue-text { color: #00ffff; font-weight: bold; }
        ul { padding-left: 18px; font-size: 0.85rem; color: #ddd; margin: 5px 0; }
        li { margin-bottom: 6px; }

        /* å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ« */
        .table-container { overflow-x: auto; }
        table { width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 0.75rem; min-width: 400px; }
        th, td { border: 1px solid #555; padding: 8px; text-align: center; }
        th { background: #444; color: #ffcc00; }
    </style>
</head>
<body>

    <h1>ğŸŒº æ²–ãƒ‰ã‚­!DUO å®Œå…¨æ”»ç•¥ãƒ„ãƒ¼ãƒ«</h1>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('tool')">åˆ¤å®šãƒ„ãƒ¼ãƒ«</div>
        <div class="tab" onclick="switchTab('analysis')">è§£ææƒ…å ±</div>
    </div>

    <div id="tool" class="content active">
        <div class="card">
            <h3>1. ç‹™ã„ç›®åˆ¤å®š</h3>
            <label>çŠ¶æ³</label>
            <select id="state">
                <option value="heaven">å¤©å›½æŠœã‘å¾Œ</option>
                <option value="reset">ãƒªã‚»ãƒƒãƒˆå¾Œ</option>
            </select>
            <label>ã‚¹ãƒ«ãƒ¼å›æ•°</label>
            <select id="thru">
                <option value="0">0ã‚¹ãƒ«ãƒ¼</option>
                <option value="1">1ã‚¹ãƒ«ãƒ¼</option>
                <option value="2">2ã‚¹ãƒ«ãƒ¼</option>
                <option value="3">3ã‚¹ãƒ«ãƒ¼</option>
                <option value="4">4ã‚¹ãƒ«ãƒ¼ä»¥ä¸Š</option>
            </select>
            <label>æ‰“ã¡å§‹ã‚ (G)</label>
            <input type="number" id="games" placeholder="ä¾‹: 150">
            <label>æ¡ä»¶ãƒã‚§ãƒƒã‚¯</label>
            <div style="margin-top:10px; line-height: 2.2; font-size: 0.85rem;">
                <input type="checkbox" id="kari_loop" style="width:auto;"> <span class="blue-text">ä»®å¤©ãƒ«ãƒ¼ãƒ—ä¸­</span> / 
                <input type="checkbox" id="dhc_fail" style="width:auto;"> <span style="color:#ffcc00;">DHCå¤±æ•—å¾Œ</span><br>
                <input type="checkbox" id="over2500" style="width:auto;"> 2500æšoræœ‰åˆ©åˆ‡æ–­ / 
                <input type="checkbox" id="flash2" style="width:auto;"> ãƒ™ãƒ«ãƒ•ãƒ©â‘¡
            </div>
            <button class="btn" onclick="checkExpectation()">æœŸå¾…å€¤ã‚’åˆ¤å®š</button>
            <div id="result" style="display:none;"></div>
        </div>

        <div class="card">
            <h3>2. å®Ÿæˆ¦ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h3>
            <input type="number" id="win_games" placeholder="å½“ãŸã£ãŸGæ•°">
            <input type="text" id="memo" style="margin-top:10px;" placeholder="ãƒ¡ãƒ¢: å¤•æ–¹ã€ãƒ‰ã‚­ãƒãƒŠå¤±æ•—ç­‰">
            <button class="btn btn-save" onclick="saveRecord()">å±¥æ­´ã«ä¿å­˜</button>
        </div>

        <div class="card">
            <div class="table-container">
                <table id="historyTable">
                    <thead>
                        <tr><th>çŠ¶æ³</th><th>ã‚¹ãƒ«ãƒ¼</th><th>é–‹å§‹</th><th>å½“é¸</th><th>ãƒ¡ãƒ¢</th></tr>
                    </thead>
                    <tbody id="historyBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="analysis" class="content">
        <div class="card">
            <h3>ğŸ’¡ ç‰¹æ®Šç‚¹æ»…ã®ç¤ºå”†ï¼ˆé‡è¦ï¼‰</h3>
            <table class="info-table">
                <tr><th>ã‚¹ãƒ­ãƒ¼/é«˜é€Ÿ</th><td><span class="highlight">é€šå¸¸Bä»¥ä¸Š</span>æ¿ƒåš</td></tr>
                <tr><th>åŒæ™‚ç‚¹æ»…</th><td><span class="highlight">é€šå¸¸Bä»¥ä¸Š</span>æ¿ƒåš</td></tr>
                <tr><th>ç‰‡æ–¹ç‚¹æ»…</th><td><span class="blue-text">å¤©å›½ä»¥ä¸Š</span>æ¿ƒåš</td></tr>
                <tr><th>ç¬ãç‚¹æ»…</th><td><span class="blue-text">å¤©å›½ä»¥ä¸Š</span>æ¿ƒåš</td></tr>
                <tr><th>ã ã‚“ã ã‚“/å³ã‹ã‚‰</th><td><span class="blue-text">å¤©å›½ä»¥ä¸Š</span>æ¿ƒåš</td></tr>
                <tr><th>ç‚¹ç¯ã®ã¿</th><td><span class="blue-text">ãƒ‰ã‚­ãƒ‰ã‚­ä»¥ä¸Š</span>æ¿ƒåšï¼</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>ğŸŒ¸ ãƒ‰ã‚­ãƒãƒŠãƒ¢ãƒ¼ãƒ‰è§£æ</h3>
            <ul style="font-size: 0.8rem;">
                <li><span class="highlight">ãƒ¢ãƒ¼ãƒ‰A/Bï¼š</span>DHCç™ºç”Ÿã›ãšã€‚</li>
                <li><span class="highlight">ãƒ¢ãƒ¼ãƒ‰Cï¼š</span>33Gã§DHCç™ºç”Ÿç‡ ä½ãƒ»æˆåŠŸæœŸå¾…åº¦ <span class="blue-text">50%</span>ã€‚</li>
                <li><span class="highlight">ãƒ¢ãƒ¼ãƒ‰Dï¼š</span>33Gã§DHCç™ºç”Ÿç‡ ä¸­ãƒ»æˆåŠŸæœŸå¾…åº¦ <span class="blue-text">100%</span>ã€‚</li>
                <li><span class="highlight">ãƒ¢ãƒ¼ãƒ‰Eï¼š</span>33Gã§DHCç™ºç”Ÿç‡ é«˜ãƒ»æˆåŠŸæ™‚ <span class="blue-text">ãƒ‰ã‚­ãƒ‰ã‚­ç§»è¡Œ</span>ï¼</li>
            </ul>
            <p style="font-size: 0.75rem; color:#ccc; margin-top:5px; padding:5px; border-top:1px dashed #555;">
                â€»<span class="highlight">DHCå¤±æ•—æ™‚</span>ã¯ä¸Šä½ãƒ¢ãƒ¼ãƒ‰ã‚’ç¶­æŒã—ã‚„ã™ã„ï¼ˆ50%ãƒ«ãƒ¼ãƒ—ï¼‰ãŸã‚ã€æ¬¡ã®å½“é¸ã¾ã§æ‰“ã¡åˆ‡ã‚Šæ¨å¥¨ï¼
            </p>
        </div>

        <div class="card">
            <h3>ğŸ“– ãƒ¢ãƒ¼ãƒ‰å¤©äº•ãƒ»çµ‚äº†ç”»é¢</h3>
            <table class="info-table">
                <tr><th>é€šå¸¸A/B</th><td>å¤©äº•<span class="highlight">800G</span></td></tr>
                <tr><th>ãƒãƒ£ãƒ³ã‚¹</th><td>å¤©äº•<span class="highlight">200G</span></td></tr>
                <tr><th>çµ‚äº†ç”»é¢ å¤•æ–¹</th><td><span class="blue-text">é€šå¸¸Bä»¥ä¸Š</span>æœŸå¾…åº¦UP</td></tr>
                <tr><th>çµ‚äº†ç”»é¢ å¤œ</th><td><span class="blue-text">é€šå¸¸Bä»¥ä¸Š</span>æ¿ƒåšï¼</td></tr>
            </table>
        </div>

        <p style="font-size: 0.7rem; text-align: center; color: #777;">å¼•ç”¨å…ƒï¼šã¡ã‚‡ã‚“ã¼ã‚Šã™ãŸæ§˜</p>
    </div>

    <script>
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function checkExpectation() {
            const state = document.getElementById('state').value;
            const thru = parseInt(document.getElementById('thru').value);
            const games = parseInt(document.getElementById('games').value) || 0;
            const kariLoop = document.getElementById('kari_loop').checked;
            const dhcFail = document.getElementById('dhc_fail').checked;
            const over2500 = document.getElementById('over2500').checked;
            const flash2 = document.getElementById('flash2').checked;
            
            const resDiv = document.getElementById('result');
            resDiv.style.display = "block";
            
            if (thru <= 3 && games > 400) {
                resDiv.className = "danger";
                resDiv.innerHTML = "ã€NGã€‘400Gè¶…ãˆã¯æ·±è¿½ã„å³ç¦ï¼";
                return;
            }
            if (dhcFail || over2500) {
                resDiv.className = "sss";
                resDiv.innerHTML = "ã€SSSç´šã€‘æœŸå¾…å€¤æœ€é«˜ï¼<br>æ‰“ã£ã¡ã‚ƒãˆãƒ‹ãƒƒã‚µãƒ³â€¼ï¸";
                return;
            }
            if (flash2) {
                resDiv.className = "safe";
                resDiv.innerHTML = "ã€ãƒ¢ãƒ¼ãƒ‰Bæ¿ƒåšã€‘<br>æ‰“ã£ã¡ã‚ƒãˆãƒ‹ãƒƒã‚µãƒ³â€¼ï¸";
                return;
            }

            let border = 999;
            if (state === "reset") {
                if (thru === 0) border = 230;
                else if (thru === 1) border = kariLoop ? 150 : 220;
                else border = 150; 
            } else {
                if (thru === 0) border = kariLoop ? 150 : 280;
                else if (thru === 1) border = kariLoop ? 150 : 200;
                else if (thru === 2) border = kariLoop ? 120 : 150;
                else if (thru === 3) border = kariLoop ? 150 : 200;
                else if (thru === 4) border = 0;
            }

            if
